#!/bin/sh
exec 2>&1

# USER and HOME are needed because forgejo doesn't actually check the user it
# runs as, but instead just grabs the variables from the environment.
export USER=_forgejo
export HOME=/var/lib/forgejo

# forgejo needs to run from its home for SSH to work properly
export FORGEJO_WORK_DIR="${HOME}"

cd "${HOME}"
exec chpst -u _forgejo:_forgejo forgejo web --config /etc/forgejo/app.ini 2>&1
